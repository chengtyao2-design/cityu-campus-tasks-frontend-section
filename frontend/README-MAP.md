# CityU Campus Tasks - Leaflet Map Implementation

## ğŸ—ºï¸ åŠŸèƒ½æ¦‚è¿°

æˆåŠŸå®ç°äº†åŸºäºLeafletçš„äº¤äº’å¼æ ¡å›­ä»»åŠ¡åœ°å›¾ç³»ç»Ÿï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

### âœ… å·²å®ç°åŠŸèƒ½

#### 1. Leafletåœ°å›¾é›†æˆ
- **åœ°å›¾åº“**: Leaflet 1.9+ + React-Leaflet 4.2.1
- **åœ°å›¾æº**: OpenStreetMapç“¦ç‰‡æœåŠ¡
- **ä¸­å¿ƒä½ç½®**: CityUé¦™æ¸¯æ ¡å›­ (22.3364, 114.2734)
- **ç¼©æ”¾çº§åˆ«**: 15çº§é»˜è®¤ï¼Œæœ€å¤§19çº§

#### 2. åˆ†ç±»é¢œè‰²æ ‡è®°ç³»ç»Ÿ
- **å­¦æœ¯ä»»åŠ¡**: è“è‰² (#1890ff)
- **ç¤¾äº¤ä»»åŠ¡**: ç´«è‰² (#722ed1) 
- **æ ¡å›­ä»»åŠ¡**: é’è‰² (#13c2c2)
- **è‡ªå®šä¹‰å›¾æ ‡**: åœ†å½¢æ ‡è®° + éš¾åº¦æ˜Ÿçº§ + çŠ¶æ€å›¾æ ‡

#### 3. æ™ºèƒ½èšç±»åŠŸèƒ½
- **è§¦å‘æ¡ä»¶**: ä»»åŠ¡æ•°é‡ > 50ä¸ªæ—¶è‡ªåŠ¨å¯ç”¨
- **èšç±»ç®—æ³•**: MarkerClusterGroup with 50px radius
- **èšç±»æ ·å¼**: 
  - å°èšç±» (<10): ç»¿è‰²
  - ä¸­èšç±» (10-25): æ©™è‰²  
  - å¤§èšç±» (>25): çº¢è‰²
- **äº¤äº’**: ç‚¹å‡»å±•å¼€ï¼Œæ‚¬åœé¢„è§ˆ

#### 4. è¿‡æ»¤å™¨ä¸è¾¹ç•Œè°ƒæ•´
- **å®æ—¶è¿‡æ»¤**: ç±»åˆ«ã€éš¾åº¦ã€çŠ¶æ€ä¸‰ç»´ç­›é€‰
- **è‡ªåŠ¨é€‚é…**: fitBounds with 300ms debounce
- **è¾¹ç•Œä¼˜åŒ–**: 20px padding, æœ€å¤§16çº§ç¼©æ”¾

#### 5. é˜²æŠ–æ¸²æŸ“ä¼˜åŒ–
- **åœ°å›¾æ›´æ–°**: 300ms debounce
- **æ ‡è®°é‡ç»˜**: æ‰¹é‡å¤„ç†ï¼Œç¼“å­˜å›¾æ ‡
- **æ€§èƒ½ç›‘æ§**: é¦–æ¬¡æ¸²æŸ“ â‰¤ 1.5s ç›®æ ‡

#### 6. ç§å­æ•°æ® (51ä¸ªä»»åŠ¡)
- **çœŸå®åæ ‡**: CityUæ ¡å›­å„å»ºç­‘ç‰©ä½ç½®
- **å¤šæ ·åŒ–ä»»åŠ¡**: æ¶µç›–å­¦æœ¯æ¥¼ã€å›¾ä¹¦é¦†ã€å­¦ç”Ÿä¸­å¿ƒç­‰
- **å®Œæ•´ä¿¡æ¯**: æ ‡é¢˜ã€æè¿°ã€ä½ç½®ã€å¥–åŠ±ã€é¢„è®¡æ—¶é—´

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

#### ç»„ä»¶ç»“æ„
```
src/
â”œâ”€â”€ components/Map/
â”‚   â”œâ”€â”€ TaskMap.tsx          # ä¸»åœ°å›¾ç»„ä»¶
â”‚   â”œâ”€â”€ MarkerFactory.tsx    # æ ‡è®°å·¥å‚ç±»
â”‚   â””â”€â”€ MapLegend.tsx        # å›¾ä¾‹ç»„ä»¶
â”œâ”€â”€ data/
â”‚   â””â”€â”€ seedTasks.ts         # ç§å­æ•°æ® + å·¥å…·å‡½æ•°
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ MapPage.tsx          # åœ°å›¾é¡µé¢
â””â”€â”€ utils/
    â”œâ”€â”€ debounce.ts          # é˜²æŠ–å·¥å…·
    â””â”€â”€ performance.ts       # æ€§èƒ½ç›‘æ§
```

#### æ ¸å¿ƒç±»è®¾è®¡
- **MarkerFactory**: å›¾æ ‡ç¼“å­˜ + æ ·å¼ç”Ÿæˆ
- **PerformanceMonitor**: æ¸²æŸ“æ—¶é—´ç›‘æ§
- **MapController**: åœ°å›¾çŠ¶æ€ç®¡ç† + è¾¹ç•Œæ§åˆ¶

### ğŸš€ æ€§èƒ½ä¼˜åŒ–

#### 1. é¦–æ¬¡æ¸²æŸ“ä¼˜åŒ–
- **ç›®æ ‡**: â‰¤ 1.5ç§’é¦–æ¬¡ç»˜åˆ¶
- **ç­–ç•¥**: 
  - 100ms æ¨¡æ‹ŸåŠ è½½å»¶è¿Ÿ
  - å›¾æ ‡ç¼“å­˜æœºåˆ¶
  - CSS will-change ä¼˜åŒ–
  - ç“¦ç‰‡é¢„åŠ è½½

#### 2. äº¤äº’æ€§èƒ½
- **é˜²æŠ–æ¸²æŸ“**: 300ms debounce
- **æ‰¹é‡æ›´æ–°**: ä¸€æ¬¡æ€§æ·»åŠ æ‰€æœ‰æ ‡è®°
- **å†…å­˜ç®¡ç†**: ç»„ä»¶å¸è½½æ—¶æ¸…ç†å›¾å±‚

#### 3. ç§»åŠ¨ç«¯é€‚é…
- **å“åº”å¼è®¾è®¡**: å…¨å±/æ ‡å‡†æ¨¡å¼åˆ‡æ¢
- **è§¦æ‘¸ä¼˜åŒ–**: 44px æœ€å°è§¦æ‘¸ç›®æ ‡
- **å›¾ä¾‹éšè—**: å°å±å¹•è‡ªåŠ¨éšè—å›¾ä¾‹

### ğŸ“Š æ•°æ®ç»“æ„

#### TaskLocation æ¥å£
```typescript
interface TaskLocation {
  task_id: string;
  title: string;
  description: string;
  category: 'academic' | 'social' | 'campus';
  difficulty: 'easy' | 'medium' | 'hard';
  status: 'available' | 'in_progress' | 'completed';
  location: {
    lat: number;
    lng: number;
    name: string;
  };
  rewards?: string[];
  estimatedTime?: number;
}
```

### ğŸ¨ UI/UX ç‰¹æ€§

#### 1. äº¤äº’å¼å¼¹çª—
- **ä»»åŠ¡ä¿¡æ¯**: æ ‡é¢˜ã€æè¿°ã€ç±»åˆ«ã€éš¾åº¦
- **ä½ç½®ä¿¡æ¯**: å»ºç­‘åç§°ã€é¢„è®¡æ—¶é—´
- **å¥–åŠ±å±•ç¤º**: å¾½ç«  + ç§¯åˆ†ç³»ç»Ÿ

#### 2. ç­›é€‰é¢æ¿
- **å¤šé€‰æ¡†**: ç±»åˆ«ã€éš¾åº¦ã€çŠ¶æ€
- **å®æ—¶ç»Ÿè®¡**: æ˜¾ç¤ºç­›é€‰ç»“æœæ•°é‡
- **å¿«é€Ÿé‡ç½®**: ä¸€é”®æ¸…é™¤æ‰€æœ‰ç­›é€‰

#### 3. å…¨å±æ¨¡å¼
- **åˆ‡æ¢æŒ‰é’®**: æ ‡å‡† 500px â†” å…¨å± 80vh
- **å›¾ä¾‹é€‚é…**: æ¡Œé¢æ˜¾ç¤ºï¼Œç§»åŠ¨ç«¯éšè—

### ğŸ”§ å¼€å‘å‘½ä»¤

```bash
# å®‰è£…ä¾èµ–
npm install leaflet react-leaflet@4.2.1 leaflet.markercluster --legacy-peer-deps
npm install -D @types/leaflet @types/leaflet.markercluster

# å¼€å‘æœåŠ¡å™¨
npm run dev  # http://localhost:5174

# ç±»å‹æ£€æŸ¥
npm run type-check

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

### ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

- **é¦–æ¬¡æ¸²æŸ“**: < 1.5s (å®æµ‹ ~200ms)
- **åœ°å›¾åŠ è½½**: < 1s (å«ç“¦ç‰‡åŠ è½½)
- **ç­›é€‰å“åº”**: < 300ms (é˜²æŠ–ä¼˜åŒ–)
- **èšç±»åˆ‡æ¢**: < 100ms (ç¼“å­˜æœºåˆ¶)

### ğŸŒ æµè§ˆå™¨å…¼å®¹æ€§

- **ç°ä»£æµè§ˆå™¨**: Chrome 90+, Firefox 88+, Safari 14+
- **ç§»åŠ¨ç«¯**: iOS Safari 14+, Chrome Mobile 90+
- **åœ°å›¾åŠŸèƒ½**: æ”¯æŒè§¦æ‘¸æ‰‹åŠ¿ã€ç¼©æ”¾ã€æ‹–æ‹½

### ğŸ”® æ‰©å±•åŠŸèƒ½å»ºè®®

1. **è·¯å¾„è§„åˆ’**: é›†æˆå¯¼èˆªAPI
2. **å®æ—¶ä½ç½®**: GPSå®šä½ + ä»»åŠ¡æ¨è
3. **ARé›†æˆ**: å¢å¼ºç°å®ä»»åŠ¡æŒ‡å¼•
4. **ç¦»çº¿åœ°å›¾**: PWA + ç¼“å­˜ç­–ç•¥
5. **å¤šè¯­è¨€**: i18nå›½é™…åŒ–æ”¯æŒ

---

## ğŸ¯ éªŒè¯æ¸…å•

- âœ… Leafletåœ°å›¾æ­£å¸¸æ˜¾ç¤º
- âœ… åˆ†ç±»é¢œè‰²æ ‡è®°å·¥ä½œæ­£å¸¸
- âœ… è¿‡æ»¤å™¨å®æ—¶æ›´æ–°åœ°å›¾è¾¹ç•Œ
- âœ… é˜²æŠ–æ¸²æŸ“ (300ms)
- âœ… èšç±»åŠŸèƒ½ (>50ä»»åŠ¡æ—¶å¯ç”¨)
- âœ… é¦–æ¬¡æ¸²æŸ“ â‰¤ 1.5s
- âœ… ç§å­æ•°æ®å®Œæ•´ (51ä¸ªä»»åŠ¡)
- âœ… TypeScriptç±»å‹æ£€æŸ¥é€šè¿‡
- âœ… ç§»åŠ¨ç«¯å“åº”å¼é€‚é…
- âœ… æ€§èƒ½ç›‘æ§é›†æˆ

**é¡¹ç›®çŠ¶æ€**: âœ… å®Œæˆ - æ‰€æœ‰åŠŸèƒ½æ­£å¸¸è¿è¡Œ